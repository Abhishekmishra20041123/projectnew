<% layout("/layouts/boilerplate") %>
<style>
    /* Responsive Design for New Listing Page */
    @media (max-width: 768px) {
        .row {
            margin-left: 0;
            margin-right: 0;
        }

        .col-8,
        .col-md-4,
        .col-md-2,
        .col-md-6,
        .col-md-8,
        .col-md-12 {
            width: 100% !important;
            padding-left: 0.75rem;
            padding-right: 0.75rem;
            margin-bottom: 1rem;
        }

        .col-8.offset-2 {
            margin-left: 0 !important;
            margin-right: 0 !important;
            padding: 0.75rem;
        }

        h1 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .form-control,
        .form-select {
            margin: 0.5rem 0;
            padding: 0.75rem;
            font-size: 16px; /* Prevents zoom on iOS */
        }

        .form-label {
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-check {
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
        }

        .form-check-label {
            font-size: 0.9rem;
        }

        .btn {
            width: 100%;
            margin: 0.5rem 0;
            padding: 0.75rem 1.5rem;
        }

        .row.mt-3 {
            margin-top: 1rem !important;
        }

        .d-flex.flex-wrap {
            gap: 0.5rem;
        }
    }

    @media (max-width: 576px) {
        .col-8.offset-2 {
            padding: 0.5rem;
        }

        h1 {
            font-size: 1.25rem;
        }

        .form-control,
        .form-select {
            padding: 0.625rem;
            font-size: 16px;
        }

        .form-check {
            margin-bottom: 0.5rem;
        }
    }
</style>
    <body>
        <div class="row">
            <div class="col-8 offset-2">
                <br><br>
                <h1>Create List Form</h1>
                <form action="/listings" method="post" novalidate class="needs-validation"
                    enctype="multipart/form-data">
                    <div>
                        <label for="title" class="form-label">Title</label>
                        <input type="text" name="listing[title]" placeholder="enter title" class="form-control"
                            required>
                        <div class="valid-feedback">Title looks good</div>
                        <div class="invalid-feedback">Title should be valid</div>
                    </div>
                    <div>
                        <label for="description" class="form-label">Description</label>
                        <textarea name="listing[description]" class="form-control" placeholder="enter description"
                            required></textarea>
                        <div class="invalid-feedback">Description must be provided</div>
                    </div>
                    <div>
                        <label for="main-image" class="form-label">Upload Main Image</label>
                        <input type="file" id="main-image" name="image" class="form-control" accept="image/*" required>
                        <small class="form-text text-muted">Upload a main image for your listing (required)</small>
                    </div>
                    <div class="mt-3">
                        <label for="additional-images" class="form-label">Upload Additional Images (Optional)</label>
                        <input type="file" id="additional-images" name="additionalImages" class="form-control"
                            accept="image/*" multiple>
                        <small class="form-text text-muted">Upload up to 10 additional images to showcase your
                            property</small>
                        <div id="file-count" class="small text-info mt-1"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <label for="price" class="form-label">Price</label>
                            <input name="listing[price]" placeholder="enter price" class="form-control" required>
                            <div class="invalid-feedback">Price should be valid</div>
                        </div>
                        <div class="col-md-4">
                            <label for="accommodates" class="form-label">Accommodates (capacity)</label>
                            <input type="number" min="1" name="listing[accommodates]" placeholder="e.g. 4"
                                class="form-control" required>
                            <div class="invalid-feedback">Enter number of guests the place can host</div>
                        </div>
                        <div class="col-md-8">
                            <label for="country" class="form-label">Country</label>
                            <input type="text" name="listing[country]" placeholder="enter country" class="form-control"
                                required>
                            <div class="invalid-feedback">Country should be valid</div>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-md-4">
                            <label for="propertyType" class="form-label">Property type</label>
                            <select name="listing[propertyType]" id="propertyType" class="form-select" required>
                                <option value="Entire place">Entire place</option>
                                <option value="Private room">Private room</option>
                                <option value="Shared room">Shared room</option>
                                <option value="Hotel room">Hotel room</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label for="bedrooms" class="form-label">Bedrooms</label>
                            <input type="number" min="0" name="listing[bedrooms]" class="form-control" value="1"
                                required>
                        </div>
                        <div class="col-md-2">
                            <label for="bathrooms" class="form-label">Bathrooms</label>
                            <input type="number" step="0.5" min="0.5" name="listing[bathrooms]" class="form-control"
                                value="1" required>
                        </div>
                        <div class="col-md-2">
                            <label for="beds" class="form-label">Beds</label>
                            <input type="number" min="1" name="listing[beds]" class="form-control" value="1" required>
                        </div>
                    </div>

                    <div class="mt-3">
                        <label class="form-label">Amenities</label>
                        <div class="row">
                            <div class="col-md-12 d-flex flex-wrap gap-3">
                                <% const amenities=['WiFi','Kitchen','Washer','Dryer','Air conditioning','Heating','TV','Hair dryer','Iron','Laptop-friendly workspace','Pool','Hot tub','Free parking','Gym','Breakfast','Family/kid friendly','Wheelchair accessible','Elevator','Fireplace','Buzzer/wireless intercom','Doorman','Shampoo','Essentials','Hangers','Translation missing','Carbon monoxide detector','Smoke detector','First aid kit','Fire extinguisher','Lock on bedroom door']; %>
                                    <% amenities.forEach(a=> { %>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="listing[amenities]"
                                                value="<%= a %>" id="amenity-<%= a %>">
                                            <label class="form-check-label" for="amenity-<%= a %>">
                                                <%= a %>
                                            </label>
                                        </div>
                                        <% }) %>
                                <!-- House Rules checkboxes moved here to keep all checkboxes together -->
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="listing[houseRules][smokingAllowed]"
                                        id="smokingAllowed">
                                    <label class="form-check-label" for="smokingAllowed">Smoking allowed</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="listing[houseRules][petsAllowed]"
                                        id="petsAllowed">
                                    <label class="form-check-label" for="petsAllowed">Pets allowed</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="listing[houseRules][eventsAllowed]"
                                        id="eventsAllowed">
                                    <label class="form-check-label" for="eventsAllowed">Events allowed</label>
                                </div>
                                <!-- Instant book checkbox moved here to keep all checkboxes together -->
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="listing[availability][instantBook]"
                                        id="instantBook">
                                    <label class="form-check-label" for="instantBook">Instant book</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- House Rules Section - All together -->
                    <div class="mt-3">
                        <label class="form-label fw-bold">House Rules & Stay Duration</label>
                        <div class="row">
                            <div class="col-md-3">
                                <label class="form-label">Check-in</label>
                                <input type="text" name="listing[houseRules][checkIn]" class="form-control"
                                    placeholder="e.g. 3:00 PM">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Check-out</label>
                                <input type="text" name="listing[houseRules][checkOut]" class="form-control"
                                    placeholder="e.g. 11:00 AM">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Min stay (nights)</label>
                                <input type="number" min="1" name="listing[houseRules][minStay]" class="form-control"
                                    value="1">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Max stay (nights)</label>
                                <input type="number" min="1" name="listing[houseRules][maxStay]" class="form-control"
                                    value="5">
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-md-4">
                            <label class="form-label">Min advance notice</label>
                            <select class="form-select" name="listing[availability][minAdvanceNotice]">
                                <option>Same day</option>
                                <option>1 day</option>
                                <option>2 days</option>
                                <option>3 days</option>
                                <option>1 week</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Max advance notice</label>
                            <select class="form-select" name="listing[availability][maxAdvanceNotice]">
                                <option>3 months</option>
                                <option>6 months</option>
                                <option>9 months</option>
                                <option selected>12 months</option>
                                <option>All dates available</option>
                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 mt-4">
                            <label for="category">Category</label>
                            <select name="listing[category]" id="category" required>
                                <option disabled selected>Select a category</option>
                                <option value="Trending">Trending</option>
                                <option value="Rooms">Rooms</option>
                                <option value="Mountain Cities">Mountain Cities</option>
                                <option value="Castles">Castles</option>
                                <option value="Swimming Pools">Swimming Pools</option>
                                <option value="Camping Ground">Camping Ground</option>
                                <option value="Cow Farms">Cow Farms</option>
                                <option value="Bus Side">Bus Side</option>
                                <option value="Sea Beaches">Sea Beaches</option>
                                <option value="Vacant">Vacant</option>
                                <option value="Hotel">Hotel</option>
                            </select>
                        </div>
                        <div class="col-md-8">
                            <label for="location" class="form-label">Location</label>
                            <input type="text" name="listing[location]" placeholder="enter location"
                                class="form-control" required>
                            <div class="invalid-feedback">Location should be valid</div>
                        </div>


                    </div>


                    <br><br>
                    <button class="btn btn-dark add-button">Add</button>
                </form>

            </div>
        </div>
        <br><br>
    </body>